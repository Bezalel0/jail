local function createESP(player)
    -- Creates a visual box around the player
    local espBox = Instance.new("BoxHandleAdornment")
    espBox.Adornee = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    espBox.Size = Vector3.new(2, 5, 2) -- Size of the ESP box
    espBox.Color3 = (player.Team.Name == "Police") and Color3.fromRGB(0, 0, 255) or
                    (player.Team.Name == "Criminals") and Color3.fromRGB(255, 0, 0) or
                    (player.Team.Name == "Prisoners") and Color3.fromRGB(255, 165, 0) or
                    Color3.fromRGB(255, 255, 255) -- Default color if team is unknown
    espBox.Transparency = 0.5
    espBox.AlwaysOnTop = true
    espBox.Parent = player.Character
end

local function updateESP()
    -- Applies ESP to all players
    for _, player in ipairs(game:GetService("Players"):GetPlayers()) do
        if player ~= game:GetService("Players").LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            createESP(player)
        end
    end
end

-- Auto-update ESP for new or respawned players
game:GetService("Players").PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        createESP(player)
    end)
end)

-- Update ESP on existing players
updateESP()
